trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  - group: app-secrets
 
# =========================
# BUILD STAGE
# =========================
stage: Build
jobs:
  - job: Build
    steps:
      # ... build steps ...


# =========================
# DEPLOY STAGE
# =========================
stage: Deploy
dependsOn: Build
jobs:
  - deployment: DeployWeb
    steps:
      - download: current
        artifact: drop

      - task: AzureWebApp@1
        inputs:
          azureSubscription: "lola-service-connection"
          appType: webAppLinux
          appName: "vercel-demo-app-ai"
          package: "$(Pipeline.Workspace)/drop/app.zip"
          appSettings: |
            -Name NODE_ENV -Value "production"
            -Name DATABASE_URL -Value "$(DATABASE_URL)"
          ConfigurationSettings: |
            -WEBSITE_NODE_DEFAULT_VERSION 20
